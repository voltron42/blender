<!DOCTYPE html>
<html>
	<head>
		<title>Testing</title>
		<style>
			.fail {
				color: red;
				font-weight: bold;
			}
			.success {
				color: green;
				text-decoration: italic;
			}
		</style>
		<script src="./testing/testtest.js"></script>
		<script src="./testing/Expectable/expecting.js"></script>
		<script src="./testing/Expectable/expectable.js"></script>
		<script src="./testing/Expectable/expect.test.js"></script>
		<script src="./testing/Suitener/suitener.js"></script>
		<script src="./testing/Suitener/suitener.test.js"></script>
		<script>
			(function(){
				this.temp = console.log;
				this.logs = [];
				console.log = function(body) {
					logs.push(body);
				}
			})()
		</script>
		<script src="./testing/Mockabilly/mockabilly.js"></script>
		<script src="./testing/Mockabilly/mockabilly_test.js"></script>
		<script src="./append/Object/object.js"></script>
		<script src="./append/Object/object.test.js"></script>
		<script src="./structure/Classify/classify.js"></script>
		<script src="./structure/Classify/classify.test.js"></script>
		<script src="./structure/Registry/registry.js"></script>
		<script src="./structure/Registry/registry.test.js"></script>
		<script>
			(function(){
				console.log = temp;
				var publish = function(log) {
					log = JSON.parse(log);
					var errorMap = {};
					log.errorLog.forEach(function(error){
						errorMap[error.path.join(" - ")] = error.error;
					})
					return log.testLog.map(function(test) {
						var path = test.join(" - ");
						if (path in errorMap) {
							var error = errorMap[path];
							var stack = [];
							if (error.stack) {
								stack = "<ul>" + error.stack.map(function(step) {
									return "<li>" + step + "</li>";
								}).join("") + "</ul>";
							}
							return [].concat([
							"<li class=\"fail\">",
								path,
								"<ul><li>",
								error.message,
								],stack,[
								"</li></ul>",
							"</li>"
							]).join("");
						} else {
							return "<li class=\"success\">" +path+ "</li>";
						}
					}).join("");
				}
				this.runAllTests = function() {
					tests.run();
					document.getElementById("output").innerHTML += logs.map(publish).join("");
				}
			})()
		</script>
	</head>
	<body onload="runAllTests()">
		<pre><ul id="output">
		</ul></pre>
	</body>
</html>